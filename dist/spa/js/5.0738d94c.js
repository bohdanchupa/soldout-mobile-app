(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"0e58":function(t,e,a){"use strict";var n=a("803d"),i=a.n(n);i.a},"44a4":function(t,e,a){"use strict";var n=a("5a71"),i=a.n(n);i.a},"5a71":function(t,e,a){},"803d":function(t,e,a){},"8fe8":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{key:"page-key-"+t.pageKey,staticClass:"page page--list-of-events content"},[a("q-header",{staticClass:"header"},[a("router-link",{attrs:{to:"/entry"}},[t._v("\n      "+t._s(t.routeTitle)+"\n    ")]),t.showCalendarFilter?a("div",{staticClass:"date-filter",on:{click:function(e){e.preventDefault(),t.showCalendarFilterPopup=!0}}},[t.dateFromFilter&&t.dateToFilter?a("span",[t._v("\n        "+t._s(t.formatDisplayDate(t.dateFromFilter))+" — "+t._s(t.formatDisplayDate(t.dateToFilter))+"\n      ")]):t._e(),a("a",{staticClass:"callendar-btn",attrs:{href:"#"}})]):t._e()],1),a("DateRangePicker",{attrs:{show:t.showCalendarFilterPopup,title:"Оберіть проміжок:",initialRange:t.dateRange},on:{submit:t.handleDateRangeSubmit,close:function(e){t.showCalendarFilterPopup=!1}}}),a("div",{staticClass:"container"},[a("form",{staticClass:"search"},[a("div",{staticClass:"input-wrapper"},[a("i",{staticClass:"search-icon"}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filterString,expression:"filterString"}],attrs:{type:"text",placeholder:"Введіть подію, яку ви шукаєте…"},domProps:{value:t.filterString},on:{input:function(e){e.target.composing||(t.filterString=e.target.value)}}}),a("a",{staticClass:"reset-btn",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.resetFilterField(e)}}})]),a("button",{on:{click:function(t){return t.preventDefault(),(!1)(t)}}},[t._v("Знайти")])]),a("ul",{staticClass:"events-list"},t._l(t.filteredEvents,(function(e,n){return a("li",{key:n},[a("router-link",{staticClass:"event-teaser",attrs:{to:"/event/"+e.id+"/"+e.title+"/"+e.city+"/"+e.concertHall+"/"+e.date+"/"+e.time+"/"+e.creator+"/"+t.isGeneral+"/"+t.isToday}},[a("i",{staticClass:"link-icon"}),a("div",{staticClass:"thumbnail-and-inf"},[a("div",{staticClass:"thumbnail",style:{"background-image":"url("+e.thumbnail+")"}}),a("div",{staticClass:"inf"},[a("h5",[t._v("Організатор: "),a("span",[t._v(t._s(e.creator))])]),a("h2",[t._v(t._s(e.title))]),a("p",[t._v(t._s(e.city)+" "+t._s(e.concertHall))]),a("p",[t._v(t._s(e.date)+" "+t._s(e.time))])])]),a("div",{staticClass:"divider"}),a("div",{staticClass:"total"},[a("p",[a("span",[t._v(t._s(e.orders))]),t._v(" Замовлення")]),a("p",[a("span",[t._v(t._s(e.tickets))]),t._v(" Квитки")]),a("p",[t._v("Сума "),a("span",[t._v(t._s(e.total))]),t._v(" грн")])])])],1)})),0)])],1)},i=[],s=(a("d25f"),a("28a5"),a("3b2b"),a("9191")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"date-range-picker-popup"},[a("div",{staticClass:"date-range-picker-popup__window"},[a("i",{staticClass:"close-picker-popup",on:{click:function(e){return e.preventDefault(),t.closePopup(e)}}}),a("h3",[t._v(t._s(t.title||"Оберіть проміжок:"))]),a("div",{staticClass:"date-labels"},[a("label",[t._v("Від: "),a("span",[t._v(t._s(t.formatDisplayDate(t.dateFrom)||"___-__-__"))])]),a("label",[t._v("До: "),a("span",[t._v(t._s(t.formatDisplayDate(t.dateTo)||"___-__-__"))])])]),a("div",{staticClass:"calendar"},[a("div",{staticClass:"calendar-header"},[a("button",{staticClass:"calendar-nav",on:{click:function(e){return e.preventDefault(),t.previousMonth(e)}}},[t._v("‹")]),a("span",{staticClass:"calendar-month"},[t._v(t._s(t.monthName)+" "+t._s(t.currentYear))]),a("button",{staticClass:"calendar-nav",on:{click:function(e){return e.preventDefault(),t.nextMonth(e)}}},[t._v("›")])]),a("div",{staticClass:"calendar-weekdays"},t._l(t.weekDays,(function(e){return a("div",{key:e,staticClass:"calendar-weekday"},[t._v(t._s(e))])})),0),a("div",{staticClass:"calendar-days"},t._l(t.calendarDays,(function(e){return a("div",{key:e.key,class:t.getDayClass(e),on:{click:function(a){return t.selectDate(e)}}},[t._v("\n          "+t._s(e.date)+"\n        ")])})),0)]),a("button",{staticClass:"btn-submit",on:{click:function(e){return e.preventDefault(),t.submitRange(e)}}},[t._v("Підтвердити")])])]):t._e()},o=[],l=(a("f576"),{name:"DateRangePicker",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Оберіть проміжок:"},initialRange:{type:Object,default:null}},data:function(){var t,e;return{dateFrom:(null===(t=this.initialRange)||void 0===t?void 0:t.from)||null,dateTo:(null===(e=this.initialRange)||void 0===e?void 0:e.to)||null,currentMonth:(new Date).getMonth(),currentYear:(new Date).getFullYear(),weekDays:["Пн","Вт","Ср","Чт","Пт","Сб","Нд"],monthNames:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"]}},computed:{monthName:function(){return this.monthNames[this.currentMonth]},calendarDays:function(){var t=[],e=new Date(this.currentYear,this.currentMonth,1),a=new Date(this.currentYear,this.currentMonth+1,0),n=e.getDay()-1;-1===n&&(n=6);for(var i=0;i<n;i++)t.push({date:"",disabled:!0,key:"empty-".concat(i)});for(var s=1;s<=a.getDate();s++)t.push({date:s,disabled:!1,fullDate:this.formatDate(new Date(this.currentYear,this.currentMonth,s)),key:"day-".concat(s)});return t}},watch:{initialRange:function(t){this.dateFrom=(null===t||void 0===t?void 0:t.from)||null,this.dateTo=(null===t||void 0===t?void 0:t.to)||null}},methods:{formatDate:function(t){var e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(a,"-").concat(n)},formatDisplayDate:function(t){if(!t)return"";var e=t.split("-");return"".concat(e[2],".").concat(e[1],".").concat(e[0])},selectDate:function(t){!t.disabled&&t.fullDate&&(!this.dateFrom||this.dateFrom&&this.dateTo?(this.dateFrom=t.fullDate,this.dateTo=null):this.dateFrom&&!this.dateTo&&(t.fullDate>=this.dateFrom?this.dateTo=t.fullDate:(this.dateTo=this.dateFrom,this.dateFrom=t.fullDate)))},getDayClass:function(t){if(t.disabled)return"calendar-day disabled";var e=["calendar-day"];return t.fullDate===this.dateFrom&&e.push("start"),t.fullDate===this.dateTo&&e.push("end"),this.dateFrom&&this.dateTo&&t.fullDate>this.dateFrom&&t.fullDate<this.dateTo&&e.push("in-range"),e.join(" ")},previousMonth:function(){0===this.currentMonth?(this.currentMonth=11,this.currentYear--):this.currentMonth--},nextMonth:function(){11===this.currentMonth?(this.currentMonth=0,this.currentYear++):this.currentMonth++},submitRange:function(){this.dateFrom&&this.dateTo&&(this.$emit("submit",{from:this.dateFrom,to:this.dateTo}),this.closePopup())},closePopup:function(){this.$emit("close")}}}),c=l,u=(a("0e58"),a("2877")),d=Object(u["a"])(c,r,o,!1,null,null,null),h=d.exports,v={name:"ListOfEvents",components:{DateRangePicker:h},data:function(){return{filterString:"",events:[],showCalendarFilter:!1,showCalendarFilterPopup:!1,dateRange:null,pageKey:0}},mounted:function(){this.gettingData()},computed:{dateFromFilter:function(){var t;return(null===(t=this.dateRange)||void 0===t?void 0:t.from)||null},dateToFilter:function(){var t;return(null===(t=this.dateRange)||void 0===t?void 0:t.to)||null},routeTitle:function(){var t="";switch(this.$route.params.listId){case"today":t="Події за сьогодні";break;case"general":t="Загальні";break;case"archive":t="Архів";break}return t},routeInf:function(){var t=this,e=!1;if(this.$route.params.eventId){var a=this.events.filter((function(e){return+e.id===+t.$route.params.eventId}))[0];e={place:a.city+" "+a.concertHall,date:a.date+" "+a.time,creator:a.creator}}return e},filteredEvents:function(){var t=this.events;if(this.filterString)for(var e=this.filterString.split(" "),a=0;a<e.length;a++)if(e[a].length>0){var n=new RegExp(e[a],"gi");t=[];for(var i=0;i<this.events.length;i++){var s="".concat(this.events[i].creator).concat(this.events[i].title).concat(this.events[i].city).concat(this.events[i].concertHall).concat(this.events[i].date).concat(this.events[i].time).concat(this.events[i].tickets).concat(this.events[i].orders).concat(this.events[i].total);n.test(s)&&t.push(this.events[i])}}return t},isGeneral:function(){var t=!1;return"general"===this.$route.params.listId&&(t=!0),t},isToday:function(){var t=!1;return"today"===this.$route.params.listId&&(t=!0),t}},methods:{gettingData:function(){var t=this;this.events=[];var e=new Date,a=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=s["h"],r={dateFrom:e.getFullYear()+"-"+n+"-"+a+"T00:00:00",dateTo:e.getFullYear()+"-"+n+"-"+a+"T23:59:59"};"archive"===this.$route.params.listId&&(i=s["i"],this.showCalendarFilter=!0),"today"===this.$route.params.listId&&(i=s["j"]),"general"===this.$route.params.listId&&(r=this.dateFromFilter&&this.dateToFilter?{dateFrom:this.dateFromFilter+"T00:00:00",dateTo:this.dateToFilter+"T23:59:59"}:null,this.showCalendarFilter=!0),this.$store.dispatch("fetchingData",{isFetching:!0}),this.$axios({methods:"get",url:i,params:r,headers:{Authorization:"Bearer  "+this.$store.getters.getAccessToken}}).then((function(e){for(var a=0;a<e.data.length;a++){var n=new Date(e.data[a].beginDate),i=n.getDate()<10?"0"+n.getDate():n.getDate(),r=n.getMonth()+1<10?"0"+n.getMonth():n.getMonth(),o=n.getHours()<10?"0"+n.getHours():n.getHours(),l=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes();t.events.push({id:e.data[a].id,creator:e.data[a].organizator.firstName+" "+e.data[a].organizator.lastName,thumbnail:s["o"]+"/image-service/image-service/file/"+e.data[a].mainImageSmall.path,title:e.data[a].eventName.valueUA,city:e.data[a].cityName.valueUA,concertHall:e.data[a].hallName.valueUA,date:"".concat(i,".").concat(r,".").concat(n.getFullYear()),time:"".concat(o,":").concat(l),orders:e.data[a].ordersCount,tickets:e.data[a].ticketsCount,total:e.data[a].moneysSum||0})}t.$store.dispatch("fetchingData",{isFetching:!1})}))},resetFilterField:function(){this.filterString=""},formatDisplayDate:function(t){if(!t)return"";var e=t.split("-");return"".concat(e[2],".").concat(e[1],".").concat(e[0])},handleDateRangeSubmit:function(t){this.dateRange=t,this.pageKey+=1,this.showCalendarFilterPopup=!1,this.gettingData()}}},f=v,p=(a("44a4"),Object(u["a"])(f,n,i,!1,null,null,null));e["default"]=p.exports}}]);